var meister=angular.module("meister",["ngMaterial","ngAnimate","ngSanitize","ngMessages","ngAria","ui.router","ngCookies","md.data.table","chart.js"]);meister.constant("SERVER_BASE_URL","http://localhost:8000/api"),function(e){e.config(["$stateProvider","$urlRouterProvider",function(e,t){t.otherwise("/login"),e.state("login",{url:"/login",templateUrl:"partials/login-partial.html",controller:"LoginController"}).state("home",{url:"/",templateUrl:"partials/home-partial.html",controller:"HomeController"}).state("about",{url:"/about",templateUrl:"partials/about-partial.html",controller:"AboutController"}).state("claims",{url:"/claims",templateUrl:"partials/claims-partial.html",controller:"ClaimsController",params:{filters:[]}}).state("sales_order",{url:"/SalesOrder",templateUrl:"partials/sales-order-partial.html",controller:"SalesOrderController",params:{filters:[]}}).state("purchase_order",{url:"/PurchaseOrder",templateUrl:"partials/purchase-order-partial.html",controller:"PurchaseOrderController",params:{filters:[]}}).state("reports",{url:"/reports",templateUrl:"partials/reports-partial.html",controller:"ReportsController",params:{filters:[]}}).state("claim-details",{url:"/claims-details",templateUrl:"partials/claim-details-partial.html",controller:"ClaimDetailsController",params:{claimno:""}}).state("reports-summary",{url:"/reports-summary",templateUrl:"partials/reports-summary-partial.html",controller:"ReportSummaryController",params:{PKY:"",reportName:""}})}]).run(["$rootScope","$location","$cookieStore","$http",function(e,t,o,l){e.globals=o.get("globals")||{},e.globals.currentUser&&(l.defaults.headers.common.Authorization="Basic "+e.globals.currentUser.authdata),e.$on("$locationChangeStart",function(o,l,r){"/login"===t.path()||e.globals.currentUser||t.path("/")})}])}(meister),function(e){e.factory("AuthenticationService",["Base64","$http","$cookieStore","$rootScope","$timeout",function(e,t,o,l,r){var a={};return a.Login=function(e,t,o){r(function(){var l={success:"arosenthal"===e&&"Pa55word."===t};l.success||(l.message="Username or password is incorrect"),o(l)},1e3)},a.SetCredentials=function(r,a){var n=e.encode(r+":"+a);l.globals={currentUser:{username:r,authdata:n}},t.defaults.headers.common.Authorization="Basic "+n,o.put("globals",l.globals)},a.ClearCredentials=function(){l.globals={},o.remove("globals"),t.defaults.headers.common.Authorization="Basic "},a}]).factory("Base64",function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(t){var o,l,r,a,n,i="",s="",c="",d=0;do{o=t.charCodeAt(d++),l=t.charCodeAt(d++),s=t.charCodeAt(d++),r=o>>2,a=(3&o)<<4|l>>4,n=(15&l)<<2|s>>6,c=63&s,isNaN(l)?n=c=64:isNaN(s)&&(c=64),i=i+e.charAt(r)+e.charAt(a)+e.charAt(n)+e.charAt(c),o=l=s="",r=a=n=c=""}while(d<t.length);return i},decode:function(t){var o,l,r,a,n,i="",s="",c="",d=0;/[^A-Za-z0-9\+\/\=]/g.exec(t)&&window.alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{r=e.indexOf(t.charAt(d++)),a=e.indexOf(t.charAt(d++)),n=e.indexOf(t.charAt(d++)),c=e.indexOf(t.charAt(d++)),o=r<<2|a>>4,l=(15&a)<<4|n>>2,s=(3&n)<<6|c,i+=String.fromCharCode(o),64!=n&&(i+=String.fromCharCode(l)),64!=c&&(i+=String.fromCharCode(s)),o=l=s="",r=a=n=c=""}while(d<t.length);return i}}})}(meister),function(e){e.factory("apiUtils",["$http","SERVER_BASE_URL",function(e,t){var o=t,l=function(e,t,l,r){var a={};return a.method=e,a.url=o+t,a.params=l||{},r&&(a.data=r),a},r={};return r.get=function(t,o,r){var a=l("GET",t,o,null);e(a).then(function(e){r(null,e.data)},function(e){r(e,null)})},r.post=function(t,o,r){var a=l("POST",t,null,o);e(a).then(function(e){r(null,e.data)},function(e){r(e,null)})},r.put=function(t,o,r){var a=l("PUT",t,null,o);e(a).then(function(e){r(null,e.data)},function(e){r(e,null)})},r.del=function(t,o,r){var a=l("DELETE",t,o,r);e(a).then(function(e){r(null,e.data)},function(e){r(e,null)})},r}])}(meister),function(e){e.factory("ClaimsService",["$http","SERVER_BASE_URL",function(e,t){var o={};return o.getList=function(){return e.get(t+"/claims")},o.getListDetails=function(){return e.get(t+"/claims/details")},o.getDetails=function(o){return e.get(t+"/claims/detail/"+o)},o.simulate=function(o){return e.get(t+'/claims/simulate?Json={"CLAIMNO":"'+o+'"}')},o.approve=function(o){var l="";return _.forEach(o,function(e){l+='{"CLAIMNO":"'+e+'"},'}),l=l.substring(0,l.length-1),e.get(t+"/claims/approve?Json=["+l+"]")},o}])}(meister),function(e){e.factory("ReportService",["$http","SERVER_BASE_URL",function(e,t){var o={};return o.getReports=function(){return e.get(t+"/reports")},o.getListReports=function(){return e.get(t+"/list_reports")},o.getDetails=function(o){return e.get(t+"/reports/detail/"+o)},o.schedule=function(o){return e.get(t+"/reports/schedule/"+o)},o.buildDataForGraphicReports=function(e){var t=_.groupBy(e,function(e){return e.PstngDate}),o={labels:[],data:[]};return _.each(t,function(e,t){o.labels.push(t);var l=0;_.each(e,function(e){l+=Number(e.Quantity.replace("-",""))}),o.data.push(l)}),o},o}])}(meister),function(e){e.factory("SalesOrderService",["$http","SERVER_BASE_URL",function(e,t){var o={};return o.execute=function(o,l){return e.get(t+"/demo/execute?Endpoint="+o+"&Json="+l)},o.buildSalesHistoryDataForGraphicReports=function(e){var t=_.groupBy(e,function(e){var t=e.DELIVERY_DATE.split("-");return t[0]+"-"+t[1]});console.log("salesHistoryGroupBy18LastMonths",t);for(var o=[],l=moment(),r=0;r<18;r++)o.push(l.format("YYYY-MM")),l=l.subtract(1,"months");o=o.reverse(),console.log("months",o);var a={labels:[],data:[]};return _.each(o,function(e){a.labels.push(e);var o=0;t[e]&&_.each(t[e],function(e){o+=e.NET_VALUE}),a.data.push(o)}),a},o}])}(meister),function(e){e.controller("AboutController",["$scope",function(e){}])}(meister),function(e){e.controller("ClaimDetailsController",["$scope","$timeout","$mdSidenav","$state","$mdMedia","$mdMenu","$mdDialog","$stateParams","ClaimsService",function(e,t,o,l,r,a,n,i,s){e.claim={},e.tabSelected=1,e.is_simulated=!1,e.simulations=[],e.isMobileDevice=r("xs"),e.init=function(){console.log(i),e.promise=s.getDetails(i.claimno),e.promise.then(function(t){if(console.log("ClaimsService.getDetails",t),e.claim=t.data,e.isMobileDevice){var o=[];_.forEach(e.claim.BUDGETS,function(t){t.WBS_ELEMENT==e.claim.APPRAISAL.WBS&&o.push(t)}),e.claim.BUDGETS=o}},function(e){console.log("failure loading claim details",e)})},_.forEach(e.budgets,function(e){e.$show=!1}),e.simulate=function(){e.promise2=s.simulate(i.claimno),e.promise2.then(function(t){if(e.is_simulated=!0,console.log("ClaimsService.simulate",t),t.data&&t.data.length>0&&(e.simulations=t.data[0],e.isMobileDevice)){var o=[];_.forEach(e.simulations,function(t){t.WBS_ELEMENT==e.claim.APPRAISAL.WBS&&o.push(t)}),e.simulations=o}},function(e){console.log("failure loading claim simulate",e)})},e.aproveConfirm=function(t){var o=n.confirm().title("You are about to Approve the following").textContent("You are about to Approve Claim No "+i.claimno).targetEvent(t).ok("Aprove").cancel("cancel");n.show(o).then(function(){e.aprove(t)},function(){e.status="You decided to keep your debt."})},e.aprove=function(t){var o=[];o.push(i.claimno),e.promise3=s.approve(o),e.promise3.then(function(o){console.log("ClaimsService.approve",o),n.show(n.alert().parent(angular.element(document.querySelector("#popupContainer"))).clickOutsideToClose(!0).title("Successful").textContent("Claim "+i.claimno+" is Approved").ok("Ok").targetEvent(t)).then(function(){l.go("claims",{filters:[e.claim]})})},function(e){console.log("failure loading claim simulate",e)})}}])}(meister),function(e){e.controller("ClaimsController",["$scope","$timeout","$mdSidenav","$mdMedia","$mdMenu","$state","$stateParams","$mdDialog","ClaimsService",function(e,t,o,l,r,a,n,i,s){function c(e){return function(){o(e).toggle()}}e.toggleLeft=c("left"),e.toggleRight=c("right"),e.claims=[],e.claims_details=[],e.total=null,e.selected=[],e.isMobileDevice=l("xs"),e.gotoClaimDetails=function(e){0!=e.ACCEPTED&&a.go("claim-details",{claimno:e.CLAIM})},e.init=function(t){console.log("init",t),console.log("params",n),e.total=null,e.claims=[],e.claims_details=[],e.promise1=s.getList(),e.promise2=s.getListDetails();var o=[];t&&e.selected.length>0&&(o=angular.copy(e.selected),e.selected=[]),e.promise1.then(function(t){console.log("ClaimsService.getList",t),_.forEach(t.data.data,function(l){if(o.length>0){var r=_.find(o,function(e){return e.WBS==l.WBS});r?t.data.total-=l.total:e.claims.push(l)}else if(n.filters.length>0){var r=_.find(n.filters,function(e){return e.APPRAISAL.WBS==l.WBS});r?t.data.total-=l.total:e.claims.push(l)}else e.claims.push(l)}),e.total=t.data.total},function(e){console.log("failure loading claims",e)}),e.promise2.then(function(t){console.log("ClaimsService.getListDetails",t),_.forEach(t.data.data,function(t){if(o.length>0){var l=_.find(o,function(e){return e.WBS==t.WBS});l||e.claims_details.push(t)}else if(n.filters.length>0){var l=_.find(n.filters,function(e){return e.APPRAISAL.WBS==t.WBS});l||e.claims_details.push(t)}else e.claims_details.push(t)})},function(e){console.log("failure loading claims details",e)})},e.showDetails=function(e){console.log("showDetails",e),e.$showTooltip=!0},e.hideDetails=function(e){console.log("hideDetails",e),e.$showTooltip=!1},e.showDetails2=function(e){console.log("showDetails",e),e.$showTooltip2=!0},e.hideDetails2=function(e){console.log("hideDetails",e),e.$showTooltip2=!1},e.aproveConfirm=function(t){console.log("Approve items selected",e.selected);var o="",l=[];_.forEach(e.selected,function(e){l.push(e.CLAIM),o+="Claim "+e.CLAIM+" on WBS "+e.WBS+" for amount $"+e.ACCEPTED.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")+"<br/>"});var r=i.confirm().title("You are about to Approve the following").htmlContent(o).targetEvent(t).ok("Aprove").cancel("cancel");i.show(r).then(function(){e.aprove(t,l)},function(){e.status="You decided to keep your debt."})},e.aprove=function(t,o){e.promise3=s.approve(o),e.promise3.then(function(o){console.log("ClaimsService.approve",o),i.show(i.alert().parent(angular.element(document.querySelector("#popupContainer"))).clickOutsideToClose(!0).title("Successful").textContent("Selected Claims are Approved").ok("Ok").targetEvent(t)).then(function(){e.init(!0)})},function(e){console.log("failure loading claim simulate",e)})}}])}(meister),function(e){e.controller("HomeController",["$scope","$rootScope","$timeout","$mdSidenav","$mdMenu","$state","$mdMedia",function(e,t,o,l,r,a,n){function i(e){return function(){l(e).toggle()}}e.toggleLeft=i("left"),e.toggleRight=i("right"),e.isMobileDevice=n("xs"),t.gotoHome=function(){t.transition="fade-in",a.go("home")},t.gotoClaims=function(){a.go("claims")},t.gotoSalesOrder=function(){a.go("sales_order")},t.gotoPurchaseOrder=function(){a.go("purchase_order")},t.gotoMainReports=function(){a.go("reports")},t.openMenu=function(e,t){e(t)},t.transition="fade-in"}])}(meister),function(e){e.controller("LoginController",["$scope","$rootScope","$location","AuthenticationService",function(e,t,o,l){l.ClearCredentials(),e.login=function(){l.Login(e.username,e.password,function(t){t.success?(l.SetCredentials(e.username,e.password),o.path("/")):e.error=t.message})}}])}(meister),function(e){e.controller("PurchaseOrderController",["$scope","$rootScope","$timeout","$filter","$mdSidenav","$mdMenu","$mdMedia","$state","$mdDialog","SalesOrderService",function(e,t,o,l,r,a,n,i,s,c){function d(e,t){return diff=Math.abs(e-t),ms=diff%1e3,diff=(diff-ms)/1e3,ss=diff%60,diff=(diff-ss)/60,mm=diff%60,diff=(diff-mm)/60,hh=diff%24,days=(diff-hh)/24,"Execution time "+hh+"."+mm+"."+ss+"."+ms+" hrs.min.sec.msec"}e.vendorArray=[{label:"1000 - C.E.B. Berlin",value:"1000"}],e.purchasingOrganizationArray=[{label:"1000 - BestRun Germany",value:"1000"}],e.plantArray=[{label:"3000 - Chicago Plant",value:"3000"}],e.orderArray=[{label:"4500022451",value:"4500022451"},{label:"New PO",value:"NEW"}],e.vendorSelected="",e.purchasingOrganizationSelected="",e.plantSelected="",e.multiplier=10,e.materialCatalog=[],e.salesOrder=[],e.log="",e.materialSelected=[],e.salesOrderSelected=[],e.orderSelected=null,e.tabSelected=0,e.notes=[],e.salesHistory=[],e.salesHistorySelected=[],e.analytics=null,e.hiddenMaterial=!1,e.hiddenNotes=!1,e.note={type:"HDR",text:"",title:"Add Note",lineNumber:1};e.searchTextOrderNumber="",e.querySearch=function(t){var o=t?e.orderArray.filter(u(t)):e.orderArray;return o};var u=function(e){return function(t){return t.label.toLowerCase().includes(e.toLowerCase())}};e.isMobileDevice=n("xs"),e.collapseParterInfo=!0,e.collapseSalesSelection=!0,e.dataForGraphicReport=[],e.labelsForGraphicReport=[],e.chartOptions={scales:{yAxes:[{ticks:{callback:function(e,t,o){return l("currency")(e,"$",0)}}}]}},e.loadMaterialCatalog=function(){if(console.log("loadMaterialCatalog"),console.log("vendorSelected",e.vendorSelected),console.log("plantSelected",e.plantSelected),console.log("purchasingOrganizationSelected",e.purchasingOrganizationSelected),!e.vendorSelected||""==e.vendorSelected||!e.plantSelected||""==e.plantSelected||!e.purchasingOrganizationSelected||""==e.purchasingOrganizationSelected)return void(e.materialCatalog=[]);var t='{"VENDOR":"'+e.vendorSelected+'","PLANT":"'+e.plantSelected+'","PURORG":"'+e.purchasingOrganizationSelected+'"}';e.log="Executing Get Catalog<br/>"+e.log;var o=new Date;e.materialCatalogProgress=c.execute("Meister.Demo.Po.Mat.Catalog",t),e.materialCatalogProgress.then(function(t){var l=new Date;console.log("Vendor result",t),e.log="Completed Get Catalog<br/>"+e.log,e.log=d(o,l)+"<br/>"+e.log,e.materialCatalog=t.data.Json},function(e){console.log("SalesOrderService.execute failure",e)}),e.getSalesPartner(),e.calculateAnalytics()},e.formatSORT_DATE=function(e){return e?8!=e.length?e:e.substring(4,6)+"/"+e.substring(6,8)+"/"+e.substring(0,4):""},e.saveNote=function(t){var o="",l="";"HDR"==e.note.type?(o="Meister.Demo.PP.Hrd.Notes",l='{"ORDERNO":"'+e.orderSelected.value+'","NOTES":[{"TEXT":"'+e.note.text+'"}]}'):"LINE"==e.note.type&&(o="Meister.Demo.PP.Line.Notes",l='{"ORDERNO":"'+e.orderSelected.value+'","LINE_ITEM":"'+e.note.lineNumber+'","NOTES":[{"TEXT":"'+e.note.text+'"}]}'),console.log("endpoint",o),console.log("json",l),e.log="Executing Save Note<br/>"+e.log;var r=new Date;e.addNoteProgress=c.execute(o,l),e.addNoteProgress.then(function(t){var o=new Date;console.log("SaveNote result",t),e.log="Completed Save Note<br/>"+e.log,e.log=d(r,o)+"<br/>"+e.log,e.note={type:"HDR",text:"",lineNumber:1},e.getListNotesByOrder();var l=s.alert({title:"Note Added",textContent:"The note was added successful",ok:"OK"});s.show(l).finally(function(){l=void 0})},function(e){console.log("SalesOrderService.execute failure",e)})},e.addLines=function(){e.salesOrder=[];var t="Meister.Demo.PO.Add.LineItems";e.disableAddLines=!0;var o='{"NUMBER":"'+e.orderSelected.value+'","REPEAT":"'+e.multiplier+'","LINEITEMS":[{"LINENO":"00010","MATERIAL":"'+e.materialSelected[0].MATERIAL+'","PLAN":"'+e.materialSelected[0].PLANT+'","QUANTITY":"1500","NETPRICE":"'+e.materialSelected[0].PRICE+'"}]}';console.log("endpoint",t),console.log("json",o),e.log="Executing Add Lines Operation<br/>"+e.log;var l=new Date;e.addLinesProgress=c.execute(t,o),e.addLinesProgress.then(function(t){e.disableAddLines=!1;var o=new Date;console.log("SalesOrderService.execute result",t),e.log="Completed Add Lines PO<br/>"+e.log,e.log=d(l,o)+"<br/>"+e.log,e.changeOrder(e.orderSelected)},function(t){e.disableAddLines=!1,console.log("SalesOrderService.execute failure",t)})},e.formatStandardDeviation=function(e){return e?e.substring(0,2)+"."+e.substring(2,4)+"%":""},e.onSelectMaterialRow=function(){console.log("onSelectMaterialRow",e.materialSelected),e.getSalesPartner()},e.notesFilter=function(t){return 0==e.salesOrderSelected.length?"HDR"==t.LINE:Number(t.LINE)==Number(e.salesOrderSelected[0].line_no)},e.onSelectSalesOrderRow=function(){console.log("onSelectSalesOrderRow",e.salesOrderSelected)},e.hideMaterials=function(){e.hiddenMaterial=!0},e.showMaterials=function(){e.hiddenMaterial=!1},e.calculateAnalytics=function(){if(e.analytics=null,console.log("calculateAnalytics..."),e.vendorSelected&&e.purchasingOrganizationSelected&&e.plantSelected&&e.organizationSelected&&e.channelSelected&&e.divisionSelected&&e.officeSelected&&e.groupSelected&&3==e.tabSelected){var t="Meister.Demo.RL.Analytics",o='{"SALESORG":"'+e.organizationSelected+'","CHANNEL":"'+e.channelSelected+'","DIVISION":"'+e.divisionSelected+'","SALESGRP":"'+e.groupSelected+'","OFFICE":"'+e.officeSelected+'","SOLDTO":"'+e.purchasingOrganizationSelected+'"}';console.log("endpoint",t),console.log("json",o),e.log="Executing Calulate Analytics<br/>"+e.log;var l=new Date;e.calculateAnalyticsProgress=c.execute(t,o),e.calculateAnalyticsProgress.then(function(t){var o=new Date;console.log("calculateAnalytics result",t),e.log="Completed Calculate Analytics<br/>"+e.log,e.log=d(l,o)+"<br/>"+e.log,e.analytics=t.data.Json[0],console.log("Analytics",e.analytics)},function(e){console.log("SalesOrderService.execute failure",e)})}},e.getListNotesByOrder=function(){console.log("Calculate getListNotesByOrder",e.orderSelected),e.notes=[];var t="Meister.Demo.PP.Read.Notes",o='{"ORDERNO":"'+e.orderSelected.value+'"}';console.log("endpoint",t),console.log("json",o),e.log="Executing Read Notes<br/>"+e.log;var l=new Date;e.getListNotesProgress=c.execute(t,o),e.getListNotesProgress.then(function(t){var o=new Date;console.log("getListNotesByOrder result",t),e.log="Completed Read Notes<br/>"+e.log,e.log=d(l,o)+"<br/>"+e.log,e.notes=t.data.Json,console.log("notes",e.notes)},function(e){console.log("SalesOrderService.execute failure",e)})},e.changeGeneric=function(){e.loadMaterialCatalog(),0==e.salesHistory.length&&e.getSalesPartner(),null==e.analytics&&e.calculateAnalytics()},e.onSalesHistorySelected=function(){console.log("onSalesHistorySelected",e.salesHistorySelected)},e.getSalesPartner=function(){if(console.log("getSalesPartner..."),e.salesHistory=[],e.salesHistorySelected=[],e.dataForGraphicReport=[],e.labelsForGraphicReport=[],e.vendorSelected&&e.purchasingOrganizationSelected&&e.plantSelected){var t="Meister.Demo.RL.Sales.History",o='{"SALESORG":"'+e.organizationSelected+'","CHANNEL":"'+e.channelSelected+'","DIVISION":"'+e.divisionSelected+'","SALESGRP":"'+e.groupSelected+'","OFFICE":"'+e.officeSelected+'","SOLDTO":"'+e.purchasingOrganizationSelected+'"}';console.log("endpoint",t),console.log("json",o),e.log="Executing Get Sales History Operation<br/>"+e.log;var l=new Date;e.salesPartnerProgress=c.execute(t,o),e.salesPartnerProgress.then(function(t){var o=new Date;console.log("Meister.Demo.RL.Sales.History result",t),e.log="Completed Sales History<br/>"+e.log,e.log=d(l,o)+"<br/>"+e.log,e.salesHistory=t.data.Json[0].HISTORY;var r=c.buildSalesHistoryDataForGraphicReports(e.salesHistory);console.log("report",r),e.dataForGraphicReport=r.data,e.labelsForGraphicReport=r.labels,console.log("Histories",e.salesHistory),console.log("dataForGraphicReport",e.dataForGraphicReport)},function(e){console.log("SalesOrderService.execute failure",e)})}},e.showAddNote=function(t){e.salesOrderSelected.length>0?(e.note.type="LINE",e.note.lineNumber=e.salesOrderSelected[0].line_no,e.note.title="Adding Notes to Line Item "+e.salesOrderSelected[0].line_no):(e.note.type="HDR",e.note.title="Adding Header notes"),s.show({contentElement:"#addNoteDialog",parent:angular.element(document.querySelector("#tablesContainerMain")),targetEvent:t,clickOutsideToClose:!0})},e.showPartnerInfo=function(){console.log("showPartnerInfo..."),e.hiddenPartnerInfo=!1},e.hidePartnerInfo=function(){console.log("hidePartnerInfo..."),e.hiddenPartnerInfo=!0},e.showLogs=function(e){s.show({contentElement:"#myDialog",parent:angular.element(document.querySelector("#tablesContainerMain")),targetEvent:e,clickOutsideToClose:!0})},e.changeOrder=function(t){if(console.log("Order",t),!t)return void(e.salesOrder=[]);if("NEW"==t.value){e.salesOrder=[];var o="Meister.Demo.PO.New.OnHold",l='{"VENDOR":"'+e.vendorSelected+'","PLANT":"'+e.plantSelected+'","PURORG":"'+e.purchasingOrganizationSelected+'"}';console.log("endpoint",o),console.log("json",l),e.log="Executing New SO<br/>"+e.log;var r=new Date;e.readOrderProgress=c.execute(o,l),e.readOrderProgress.then(function(t){var o=new Date;console.log("SalesOrderService.execute result",t),e.log="Completed New PO<br/>"+e.log,e.log=d(r,o)+"<br/>"+e.log;var l=t.data.Json[0].NUMBER,a={label:l,value:l};e.orderArray.push(a),e.orderSelected=a,e.getListNotesByOrder()},function(e){console.log("SalesOrderService.execute failure",e)})}else{e.getListNotesByOrder();var o="Meister.Demo.PO.Read",l='{"NUMBER":"'+t.value+'"}';e.log="Executing Read SO<br/>"+e.log;var r=new Date;e.readOrderProgress=c.execute(o,l),e.readOrderProgress.then(function(t){var o=new Date;e.disableAddLines=!1,console.log("SalesOrderService.execute result",t),e.log="Completed Read PO<br/>"+e.log,e.log=d(r,o)+"<br/>"+e.log,e.salesOrder=t.data.Json[0].lineitem},function(t){e.disableAddLines=!1,console.log("SalesOrderService.execute failure",t)})}}}])}(meister),function(e){e.controller("ReportsController",["$scope","$timeout","$mdSidenav","$state","$mdMedia","$mdMenu","$mdDialog","$stateParams","$mdToast","ReportService",function(e,t,o,l,r,a,n,i,s,c){e.isMobileDevice=r("xs"),e.reports=[],e.list_reports=[],e.report="",e.selected=[],e.init=function(){e.promise2=c.getListReports(),e.promise2.then(function(t){console.log("ReportService.getListReports",t),e.list_reports=t.data,e.list_reports.length>0&&(e.reports.push(e.list_reports[0]),e.report=e.list_reports[0].REPORT_NAME)},function(e){console.log("failureReportService.getListReports",e)})},e.schedule=function(t,o){console.log("schedule",o),n.show(n.alert().parent(angular.element(document.querySelector("#popupContainer"))).clickOutsideToClose(!0).title("Schedule Report successfull").textContent("Schedule Report success").ok("Ok").targetEvent(t)).then(function(){e.promise=c.schedule(o),e.promise.then(function(t){console.log("ReportService.schedule",t),e.init()},function(e){console.log("ReportService.schedule",e)})})},e.gotoReportSummary=function(e){"F"==e.STATUS?l.go("reports-summary",{PKY:e.PKY,reportName:e.REPORT_NAME}):s.show(s.simple().textContent("Report output is being prepared. Check back in a few minutes.").position("bottom").hideDelay(3e3))}}])}(meister),function(e){e.controller("ReportSummaryController",["$scope","$state","$mdMedia","$mdDialog","$stateParams","$timeout","ReportService",function(e,t,o,l,r,a,n){e.data=[],e.chartType="bar",e.isMobileDevice=o("xs"),e.chartData=[],e.labels=[],e.report_name="",e.filterDate="",e.chartOptions={onClick:function(t){var o=this.getElementAtEvent(t);if(o.length){var l=o[0]._index;a(function(){e.filterDate=e.labels[l]}),console.log(e.filterDate)}}},e.init=function(){console.log(r.PKY),e.report_name=r.reportName,e.promise=n.getDetails(r.PKY),e.promise.then(function(t){e.data=t.data,e.generateChart()},function(e){console.log("failure loading report details",e)})},e.gotoReports=function(){t.go("reports")},e.generateChart=function(){var t=n.buildDataForGraphicReports(e.data);e.chartData=t.data,e.labels=t.labels},e.removeFilters=function(){e.filterDate=""}}])}(meister),function(e){e.controller("SalesOrderController",["$scope","$rootScope","$timeout","$filter","$mdSidenav","$mdMenu","$mdMedia","$state","$mdDialog","SalesOrderService",function(e,t,o,l,r,a,n,i,s,c){function d(e,t){return diff=Math.abs(e-t),ms=diff%1e3,diff=(diff-ms)/1e3,ss=diff%60,diff=(diff-ss)/60,mm=diff%60,diff=(diff-mm)/60,hh=diff%24,days=(diff-hh)/24,"Execution time "+hh+"."+mm+"."+ss+"."+ms+" hrs.min.sec.msec"}e.shipToArray=[{label:"3000 - Smith Inc. LLC",value:"3000"}],e.soldToArray=[{label:"3000 - Smith Inc. LLC",value:"3000"}],e.payerArray=[{label:"3050 - Bush Holdings, Inc.",value:"3050"}],e.organizationArray=[{label:"3000 - USA Philadelphia",value:"3000"}],e.channelArray=[{label:"10 - Final customer sales",value:"10"}],e.divisionArray=[{label:"00 - Cross-division ",value:"00"}],e.officeArray=[{label:"3010 - Office Chicago",value:"3010"}],e.groupArray=[{label:"311 - Group C1",value:"311"}],e.orderArray=[{label:"20168",value:"20168"},{label:"New SO",value:"NEW"}],e.shipToSelected="",e.shipTo2Selected="",e.soldToSelected="",e.payerSelected="",e.organizationSelected="",e.channelSelected="",e.divisionSelected="",e.officeSelected="",e.groupSelected="",e.multiplier=10,e.materialCatalog=[],e.salesOrder=[],e.log="",e.materialSelected=[],e.salesOrderSelected=[],e.orderSelected=null,e.tabSelected=0,e.ats={},e.notes=[],e.salesHistory=[],e.salesMaterial=[],e.salesMaterialPage=[],e.salesHistorySelected=[],e.salesMaterialSelected=[],e.analytics=null,e.hiddenMaterial=!1,e.hiddenATP=!1,e.hiddenNotes=!1,e.note={type:"HDR",text:"",title:"Add Note",lineNumber:1};e.searchTextOrderNumber="",e.querySearch=function(t){var o=t?e.orderArray.filter(u(t)):e.orderArray;return o};var u=function(e){return function(t){return t.label.toLowerCase().includes(e.toLowerCase())}};e.isMobileDevice=n("xs"),e.collapseParterInfo=!0,e.collapseSalesSelection=!0,e.dataForGraphicReport=[],e.labelsForGraphicReport=[],e.chartOptions={scales:{yAxes:[{ticks:{callback:function(e,t,o){return l("currency")(e,"$",0)}}}]}},e.changeShipTo=function(t){if(console.log("changeShipTo",t),t&&""!=t){var o='{"VENDOR":"'+t+'","PLANT":"'+t+'","PURORG":"'+t+'"}';e.log="Executing Get Catalog<br/>"+e.log;var l=new Date;e.materialCatalogProgress=c.execute("Meister.Demo.Po.Mat.Catalog",o),e.materialCatalogProgress.then(function(t){var o=new Date;console.log("SalesOrderService.execute result",t),e.log="Completed Get Catalog<br/>"+e.log,e.log=d(l,o)+"<br/>"+e.log,e.materialCatalog=t.data.Json},function(e){console.log("SalesOrderService.execute failure",e)})}e.getSalesPartner(),e.calculateAnalytics()},e.formatSORT_DATE=function(e){return e?8!=e.length?e:e.substring(4,6)+"/"+e.substring(6,8)+"/"+e.substring(0,4):""},e.saveNote=function(t){var o="",l="";"HDR"==e.note.type?(o="Meister.Demo.PP.Hrd.Notes",l='{"ORDERNO":"'+e.orderSelected.value+'","NOTES":[{"TEXT":"'+e.note.text+'"}]}'):"LINE"==e.note.type&&(o="Meister.Demo.PP.Line.Notes",l='{"ORDERNO":"'+e.orderSelected.value+'","LINE_ITEM":"'+e.note.lineNumber+'","NOTES":[{"TEXT":"'+e.note.text+'"}]}'),console.log("endpoint",o),console.log("json",l),e.log="Executing Save Note<br/>"+e.log;var r=new Date;e.addNoteProgress=c.execute(o,l),e.addNoteProgress.then(function(t){var o=new Date;console.log("SaveNote result",t),e.log="Completed Save Note<br/>"+e.log,e.log=d(r,o)+"<br/>"+e.log,e.note={type:"HDR",text:"",lineNumber:1},e.getListNotesByOrder();var l=s.alert({title:"Note Added",textContent:"The note was added successful",ok:"OK"});s.show(l).finally(function(){l=void 0})},function(e){console.log("SalesOrderService.execute failure",e)})},e.addLines=function(){e.salesOrder=[];var t="Meister.Demo.RL.SD.Update";e.disableAddLines=!0;var o='{"ORDERNO":"'+e.orderSelected.value+'","REPEAT":"'+e.multiplier+'","MATERIAL":"'+e.materialSelected[0].MATERIAL+'","QTY":"1","UOM":"'+e.materialSelected[0].UOM+'"}';console.log("endpoint",t),console.log("json",o),e.log="Executing Add Lines Operation<br/>"+e.log;var l=new Date;e.addLinesProgress=c.execute(t,o),e.addLinesProgress.then(function(t){e.disableAddLines=!1;var o=new Date;console.log("SalesOrderService.execute result",t),e.log="Completed Add Lines Operation<br/>"+e.log,e.log=d(l,o)+"<br/>"+e.log,e.changeOrder(e.orderSelected.value)},function(t){e.disableAddLines=!1,console.log("SalesOrderService.execute failure",t)})},e.formatStandardDeviation=function(e){return e?e.substring(0,2)+"."+e.substring(2,4)+"%":""},e.onSelectMaterialRow=function(){console.log("onSelectMaterialRow",e.materialSelected),e.calculateATS(),e.getSalesPartner()},e.notesFilter=function(t){return 0==e.salesOrderSelected.length?"HDR"==t.LINE:Number(t.LINE)==Number(e.salesOrderSelected[0].line_no)},e.onSelectSalesOrderRow=function(){console.log("onSelectSalesOrderRow",e.salesOrderSelected)},e.hideMaterials=function(){e.hiddenMaterial=!0},e.showMaterials=function(){e.hiddenMaterial=!1},e.calculateAnalytics=function(){if(e.analytics=null,console.log("calculateAnalytics..."),e.shipToSelected&&e.shipTo2Selected&&e.soldToSelected&&e.payerSelected&&e.organizationSelected&&e.channelSelected&&e.divisionSelected&&e.officeSelected&&e.groupSelected&&3==e.tabSelected){var t="Meister.Demo.RL.Analytics",o='{"SALESORG":"'+e.organizationSelected+'","CHANNEL":"'+e.channelSelected+'","DIVISION":"'+e.divisionSelected+'","SALESGRP":"'+e.groupSelected+'","OFFICE":"'+e.officeSelected+'","SOLDTO":"'+e.soldToSelected+'"}';console.log("endpoint",t),console.log("json",o),e.log="Executing Calulate Analytics<br/>"+e.log;var l=new Date;e.calculateAnalyticsProgress=c.execute(t,o),e.calculateAnalyticsProgress.then(function(t){var o=new Date;console.log("calculateAnalytics result",t),e.log="Completed Calculate Analytics<br/>"+e.log,e.log=d(l,o)+"<br/>"+e.log,e.analytics=t.data.Json[0],console.log("Analytics",e.analytics)},function(e){console.log("SalesOrderService.execute failure",e)})}},e.getListNotesByOrder=function(){console.log("Calculate getListNotesByOrder",e.orderSelected),e.notes=[];var t="Meister.Demo.PP.Read.Notes",o='{"ORDERNO":"'+e.orderSelected.value+'"}';console.log("endpoint",t),console.log("json",o),e.log="Executing Read Notes<br/>"+e.log;var l=new Date;e.getListNotesProgress=c.execute(t,o),e.getListNotesProgress.then(function(t){var o=new Date;console.log("getListNotesByOrder result",t),e.log="Completed Read Notes<br/>"+e.log,e.log=d(l,o)+"<br/>"+e.log,e.notes=t.data.Json,console.log("notes",e.notes)},function(e){console.log("SalesOrderService.execute failure",e)})},e.changeGeneric=function(){0==e.salesHistory.length&&e.getSalesPartner(),null==e.analytics&&e.calculateAnalytics()},e.onSalesHistorySelected=function(){console.log("onSalesHistorySelected",e.salesHistorySelected)},e.getSalesPartner=function(){if(console.log("getSalesPartner..."),e.salesHistory=[],e.salesHistorySelected=[],e.dataForGraphicReport=[],e.labelsForGraphicReport=[],e.shipToSelected&&e.shipTo2Selected&&e.soldToSelected&&e.payerSelected&&e.organizationSelected&&e.channelSelected&&e.divisionSelected&&e.officeSelected&&e.groupSelected){var t="Meister.Demo.RL.Sales.History",o='{"SALESORG":"'+e.organizationSelected+'","CHANNEL":"'+e.channelSelected+'","DIVISION":"'+e.divisionSelected+'","SALESGRP":"'+e.groupSelected+'","OFFICE":"'+e.officeSelected+'","SOLDTO":"'+e.soldToSelected+'"}';console.log("endpoint",t),console.log("json",o),e.log="Executing Get Sales History Operation<br/>"+e.log;var l=new Date;e.salesPartnerProgress=c.execute(t,o),e.salesPartnerProgress.then(function(t){var o=new Date;console.log("Meister.Demo.RL.Sales.History result",t),e.log="Completed Sales History<br/>"+e.log,e.log=d(l,o)+"<br/>"+e.log,e.salesHistory=t.data.Json[0].HISTORY;var r=c.buildSalesHistoryDataForGraphicReports(e.salesHistory);console.log("report",r),e.dataForGraphicReport=r.data,e.labelsForGraphicReport=r.labels,console.log("Histories",e.salesHistory),console.log("dataForGraphicReport",e.dataForGraphicReport)},function(e){console.log("SalesOrderService.execute failure",e)})}},e.showAddNote=function(t){e.salesOrderSelected.length>0?(e.note.type="LINE",e.note.lineNumber=e.salesOrderSelected[0].line_no,e.note.title="Adding Notes to Line Item "+e.salesOrderSelected[0].line_no):(e.note.type="HDR",e.note.title="Adding Header notes"),s.show({contentElement:"#addNoteDialog",parent:angular.element(document.querySelector("#tablesContainerMain")),targetEvent:t,clickOutsideToClose:!0})},e.showAtpDialog=function(e){s.show({contentElement:"#atpContainer",parent:angular.element(document.querySelector("#tablesContainerMain")),targetEvent:e,clickOutsideToClose:!0})},e.showPartnerInfo=function(){console.log("showPartnerInfo..."),e.hiddenPartnerInfo=!1},
e.hidePartnerInfo=function(){console.log("hidePartnerInfo..."),e.hiddenPartnerInfo=!0},e.calculateATS=function(){console.log("Calculate ATS",e.materialSelected[0]),e.salesMaterial=[],e.salesMaterialPage=[];var t='{"MATERIAL":"'+e.materialSelected[0].MATERIAL+'","PLANT":"'+e.materialSelected[0].PLANT+'"}';console.log("endpoint","Meister.Demo.RL.Stock"),console.log("json",t),e.log="Executing Calculate ATS<br/>"+e.log;var o=new Date;e.calculateATSProgress=c.execute("Meister.Demo.RL.Stock",t),e.calculateATSProgress.then(function(t){var l=new Date;console.log("calculateATS result",t),e.log="Completed Calculate ATS<br/>"+e.log,e.log=d(o,l)+"<br/>"+e.log,e.ats=t.data.Json[0].DETAILS[0].DETAIL,e.salesMaterial=t.data.Json[0].DETAILS[0].MRP,console.log("ats",e.ats)},function(e){console.log("SalesOrderService.execute failure",e)})},e.showLogs=function(e){s.show({contentElement:"#myDialog",parent:angular.element(document.querySelector("#tablesContainerMain")),targetEvent:e,clickOutsideToClose:!0})},e.changeOrder=function(t){if(console.log("Payer",e.payerSelected),!t)return void(e.salesOrder=[]);if("NEW"==t.value){e.salesOrder=[];var o="Meister.Demo.RL.SD.New.Parked",l='{"DOCTYPE":"CM","SALESORG":"'+e.organizationSelected+'","DIST":"'+e.channelSelected+'","DIVISION":"'+e.divisionSelected+'","SALESGRP":"'+e.groupSelected+'","SALESOFF":"'+e.officeSelected+'","SOLDTO":"'+e.soldToSelected+'","PAYER":"'+e.payerSelected+'"}';console.log("endpoint",o),console.log("json",l),e.log="Executing New SO<br/>"+e.log;var r=new Date;e.readOrderProgress=c.execute(o,l),e.readOrderProgress.then(function(t){var o=new Date;console.log("SalesOrderService.execute result",t),e.log="Completed New SO<br/>"+e.log,e.log=d(r,o)+"<br/>"+e.log;var l=t.data.Json[0].ORDERNO;l=l.substring(l.length-5,l.length);var a={label:l,value:l};e.orderArray.push(a),e.orderSelected=a,e.getListNotesByOrder()},function(e){console.log("SalesOrderService.execute failure",e)})}else{e.getListNotesByOrder();var o="Meister.Demo.RL.SD.Read",l='{"ORDER":"'+t.value+'"}';e.log="Executing Read SO<br/>"+e.log;var r=new Date;e.readOrderProgress=c.execute(o,l),e.readOrderProgress.then(function(t){var o=new Date;e.disableAddLines=!1,console.log("SalesOrderService.execute result",t),e.log="Completed Read SO<br/>"+e.log,e.log=d(r,o)+"<br/>"+e.log,e.salesOrder=t.data.Json[0].lineitem},function(t){e.disableAddLines=!1,console.log("SalesOrderService.execute failure",t)})}}}])}(meister);